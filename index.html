<!DOCTYPE html>
<head>
  <title>Pusher Test</title>
  <script src="https://js.pusher.com/8.2.0/pusher.min.js"></script>
  <script>
    // Enable pusher logging - don't include this in production
    Pusher.logToConsole = true;

    var pusher = new Pusher("e5c334e47fb12f7c46ff", {
      cluster: "ap1",
    });

    var channel = pusher.subscribe("my-channel");
    channel.bind("my-event", function (data) {
      //alert(JSON.stringify(data));
      // Check if the browser supports notifications
      // Check if notifications are supported
      if ("Notification" in window) {
        // Request permission
        Notification.requestPermission().then(function (permission) {
          
          //if (permission === "granted") {
            // Create a custom notification with title, body, and icon
            let notificationOptions = {
              body: data.message, // Replace with your message
              icon: "https://example.com/icon.png", // Replace with your icon URL
              tag: "message-notification", // You can use this to tag similar notifications
              //vibrate: [200, 100, 200], // Optional vibration pattern for mobile devices
              requireInteraction: true, // Makes the notification stay until the user interacts
              renotify: true, // Allows multiple notifications to overwrite previous ones with the same tag
            };

            // Display the notification
            let notification = new Notification(
              "New Message!",
              notificationOptions
            );

            // Optional: Add an event listener for when the notification is clicked
            notification.onclick = function () {
              window.open("https://brms.iauoffsa.us"); // Redirect when the user clicks the notification
            };
          //} else {
            //console.log("Notification permission denied.");
          //}
        });
      } else {
        console.log("Notifications are not supported by this browser.");
      }
    });
  </script>
</head>
<body>
  <h1>Pusher Test</h1>
  <p>
    Try publishing an event to channel <code>my-channel</code> with event name
    <code>my-event</code>.
  </p>
</body>
